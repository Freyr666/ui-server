let stream_type_to_string = function
  | 0x00 -> "Reserved"
  | 0x01 -> "Video MPEG-1"
  | 0x02 -> "Video MPEG-2"
  | 0x03 -> "Audio MPEG-1"
  | 0x04 -> "Audio MPEG-2"
  | 0x05 -> "Private sections"
  | 0x06 -> "Private PES packets"
  | 0x07 -> "MHEG"
  | 0x08 -> "DSM-CC"
  | 0x09 -> "H.222.1"
  | 0x0A -> "DSM-CC Type A"
  | 0x0B -> "DSM-CC Type B"
  | 0x0C -> "DSM-CC Type C"
  | 0x0D -> "DSM-CC Type D"
  | 0x0E -> "Auxiliary"
  | 0x0F -> "Audio AAC ADTS"
  | 0x10 -> "Video MPEG-4"
  | 0x11 -> "Audio AAC LATM"
  | 0x12 -> "SL FlexMux PES packets"
  | 0x13 -> "SL FlexMux sections"
  | 0x14 -> "Synchronized download"
  | 0x15 -> "Metadata PES packets"
  | 0x16 -> "Metadata sections"
  | 0x17 -> "Metadata data carousel"
  | 0x18 -> "Metadata object carousel"
  | 0x19 -> "Metadata synchronized download"
  | 0x1A -> "MPEG-2 IPMP"
  | 0x1B -> "Video H264"
  | 0x1C -> "Audio AAC Clean"
  | 0x1D -> "MPEG-4 timed text"
  | 0x1E -> "Video RVC"
  | 0x1F -> "Video H264 SVC sub-bitstream"
  | 0x20 -> "Video H264 MVC sub-bitstream"
  | 0x21 -> "Video JP2K"
  | 0x22 -> "Video MPEG-2 stereo additional view"
  | 0x23 -> "Video H264 stereo additional view"
  | 0x24 -> "Video HEVC"
  | 0x25 -> "Video HEVC temporal subset"
  | 0x26 -> "Video H264 MVCD sub-bitstream"
  | x when x >= 0x27 && x <= 0x7E -> "Reserved"
  | 0x7F -> "IPMP stream"
  | x when x >= 0x80 && x <= 0xFF -> "User Private"
  | _    -> "Unknown"
